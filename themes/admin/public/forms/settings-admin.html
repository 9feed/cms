<div data---="form__common.form__if:settings-admin;width:500;submit:settingsform/submit;autofocus:true;icon:user;title:@(Administrator)" class="hidden">

	<div class="padding npb">
		<div class="row">
			<div class="col-md-12 m">
				<div data---="input__settings.formuser.name__placeholder:@(Peter Sirka);required:true">@(User name)</div>
			</div>
		</div>
		<div class="row">
			<div class="col-md-12 m">
				<div data---="input__settings.formuser.login__required:true;placeholder:@(petersirka)">@(Login name)</div>
			</div>
		</div>
		<div class="row">
			<div class="col-md-12 m">
				<div data---="input__settings.formuser.password__required:true">@(Login password)</div>
				<div class="help"><span class="link exec" data-exec="settingsform/password">@(Generate password)</span></div>
			</div>
		</div>
		<div class="row">
			<div class="col-md-12 m">
				<div data---="dropdowncheckbox__settings.formuser.roles__alltext:null;items:[roles]">@(Roles)</div>
				<div class="help">@(If the user roles will be empty then the user will be access to all functionality.)</div>
			</div>
		</div>
	</div>

	<nav data---="validation__settings.formuser">
		<button name="submit">@(SAVE)</button>
		<button name="cancel">@(Cancel)</button>
	</nav>

</div>

<script>

	PLUGIN('settingsform', function(exports) {

		exports.password = function() {
			SET('settings.formuser.password', GUID(10));
		};

		exports.submit = function(hide) {

			hide();

			var frm = settings.formuser;

			if (frm.id) {
				var user = settings.form.users.findItem('id', frm.id);
				user.name = frm.name;
				user.login = frm.login;
				user.password = frm.password;
				user.roles = frm.roles;
				UPDATE('settings.form.users');
			} else {
				frm.id = GUID(15);
				PUSH('settings.form.users', frm);
			}

			// Performs change for validation
			CHANGE('settings.form.url');
		};
	});

</script>